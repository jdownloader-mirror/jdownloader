$(function(){initComplete=false;function b(h){console.log(h);if(h==""){h="&nbsp;"}$("#status").html(h)}function d(h){console.log(h);b("Connection etablished.");if($.webStorage.local().getItem("autologin")===true){$("#auth .do").click()}}function c(h){console.log(h);window.history.back();b("");b("Waiting for Captchas!");if($("#remember").is(":checked")){$.each(f,function(k,j){o=$("#"+j);if(o.is('[type="checkbox"]')){var l=(o.attr("checked")==="checked");$.webStorage.local().setItem(j,l)}else{$.webStorage.local().setItem(j,o.val())}})}else{$.each(f,function(k,j){$.webStorage.local().removeItem(j)})}}function g(h){$("#captcha #display").slideToggle();captchaSound.play();console.log(h)}$("#connect .do").click(function(){b("Connecting...");$.jd.setOptions({apiServer:$("#apiurl").val(),apiTimeout:200}).send("ping",d)});$("#auth .do").click(function(){$.jd.stopSession();b("Authenticating...");$.jd.setOptions({user:$("#username").val(),pass:$("#pass")}).startSession(c)});$("#captcha .solve").click(function(){g()});$("#remember").click(function(h){$("#autologin").parent().parent().toggle();if(!$("#remember").is(":checked")){$("#autologin").removeAttr("checked")}});$(".back").click(function(){$.jd.stopSession();window.history.back();b("");return false});$(".do").click(function(){$.history.load($(this).data("href"))});function e(i){if(!initComplete){return}if(i===""){i="connect"}console.log("hashChanged: "+i);var j=$(".active");var h=$("#"+i);if(!h.is(j)){h.addClass("active");j.removeClass("active").stop(true,true).slideToggle(function(){h.slideToggle()})}}window.location.hash="";$.history.init(e);var f=["user","pass","remember","autologin","apiurl","sound"];$.each(f,function(j,h){o=$("#"+h);if(o.is('[type="checkbox"]')){if($.webStorage.local().getItem(h)===true){o.click()}else{if($.webStorage.local().getItem(h)){o.val($.webStorage.local().getItem(h))}}}});if($.browser.webkit===true){$(".back").unbind("click").click(function(){$.webStorage.local().removeItem("autologin");location.reload()})}captchaSound=new buzz.sound("./sounds/captcha",{formats:["ogg","mp3"],preload:true,autoplay:false,loop:false});var a=navigator.userAgent.match(/iPad|iPhone|android|symian|maemo|meego|webos|phone|mobile/i);if(a){$.fx.off=true}b("");initComplete=true;if($.webStorage.local().getItem("autologin")){$("#connect .do").click()}});